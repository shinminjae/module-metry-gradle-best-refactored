
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>AWS IoT 데이터 검색</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="container mt-4">
<h2>AWS IoT 데이터 검색</h2>
<form method="post" action="/search" class="row g-3">
    <div class="col-md-3"><label>시작일시</label><input type="datetime-local" name="startDate" class="form-control"></div>
    <div class="col-md-3"><label>종료일시</label><input type="datetime-local" name="endDate" class="form-control"></div>
    <div class="col-md-2"><label>디바이스ID</label><input type="text" name="deviceId" class="form-control"></div>
    <div class="col-md-2"><label>토픽</label><input type="text" name="topic" class="form-control"></div>
    <div class="col-md-2"><label>데이터 타입</label><input type="text" name="dataType" class="form-control"></div>
    <div class="col-md-2"><label>최소값</label><input type="number" step="0.01" name="minValue" class="form-control"></div>
    <div class="col-md-2"><label>최대값</label><input type="number" step="0.01" name="maxValue" class="form-control"></div>
    <div class="col-md-2"><label>정렬</label>
        <select name="sort" class="form-select">
            <option value="DESC">최신순</option>
            <option value="ASC">오래된순</option>
        </select>
    </div>
    <div class="col-12">
        <button type="submit" class="btn btn-primary">검색</button>
        <a href="/export" class="btn btn-success">CSV 다운로드</a>
    </div>
</form>
<hr>
<table class="table table-bordered mt-3">
<thead><tr><th>수신시각</th><th>디바이스ID</th><th>토픽</th><th>데이터타입</th><th>값</th><th>원본메시지</th></tr></thead>
<tbody>
<tr th:each="msg : ${messages}">
    <td th:text="${msg.receivedAt}"></td>
    <td th:text="${msg.deviceId}"></td>
    <td th:text="${msg.topic}"></td>
    <td th:text="${msg.dataType}"></td>
    <td th:text="${msg.value}"></td>
    <td th:text="${msg.rawMessage}"></td>
</tr>
</tbody>
</table>
</body>
</html>
